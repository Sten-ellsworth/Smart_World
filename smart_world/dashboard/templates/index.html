{% extends 'base.html' %}
{% block content %}
{% load staticfiles %}

 <script type="text/javascript"
         src="https://www.gstatic.com/charts/loader.js">
 </script>

<div class="row">
    <div class="col"
         style="background-color:#4f4f4f;"
    >
        <center>
            <img src= "{% static 'images/wf.png' %}"
                 alt="Text to display if image is not found">
        </center>
    </div>
</div>

<div class="row">
    <div class="col-6 text-center">
            <div class="center border-right"
                 style="margin-top: 30px;">
                <h3>
                    <strong>Parkeergarage Windesheim Flevoland</strong>
                </h3>
                <button id="vrij"
                        type="button"
                        class="btn btn-success btn-lg"
                        style="padding: 10px 20px;
                        font-size: 20px;
                        border-radius: 10px;
                        width:120px;
                        {% if not empty_or_full_value %} display: none;
                        {% endif %}"
                >Vrij</button>
                <button id="vol"
                        type="button"
                        class="btn btn-danger btn-lg"
                        style="padding: 10px 20px;
                        font-size: 20px;
                        border-radius: 10px;
                        width:120px;
                        {% if empty_or_full_value %}
                        display: none;
                        {% endif %}"
                >Vol</button>
            </div>
    </div>
    <div class="col-6 text-center">
        <div class="bezet"
             style="margin-top: 30px;
             margin-right: 100px;">

                <h3>
                    <strong>Plaatsen beschikbaar</strong>
                </h3>
                {% for data in graphQuery%}
                {{data.sensorValue}}
                {%endfor%}
                <p style="font-size:200%">
                    {{graphQuery}}
                </p>
            <p style="font-size:200%"
               id="sensorValues">
                {{empty_or_full_value.count}}/{{sensor.count}}
            </p>
        </div>
    </div>
</div>
</div>

<hr>
<!--Grafiek-->

  <br>
<center>
    <p style="font-size:30px;">
        <b>Parkeerplaats grafiek</b>
    </p>
      <div id="ParkeerGrafiek"></div>
</center>

</head>

<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous">
</script>
<script>
    //check of javascript is ready to start
    $(document).ready(function() {
        setInterval(() => { // set interval each second
            $.get("/sensor", (sensors) => { //get api /sensor
                let count = 0; // empty_or_full_value.count
                for(let index in sensors) { //loop
                    if(sensors[index].sensorValue === 1) count++; //is sensorValue = 1 ++
                }
                let output = `${count}/${sensors.length}`; //html format
                $("#sensorValues").html(output); //write html

                if(count === 0) {
                    $("#vrij").hide();
                    $("#vol").show();
                } else {
                    $("#vrij").show();
                    $("#vol").hide();
                }
            });
        }, 10000);
    });
</script>


{% endblock %}